var globalsocket;var globalstompClient;var headers={};headers.page=document.URL;globalconnect(headers);function replaceArgumets(d,b){const a=/{(\d*?)}/g;var c=d.replace(a,function(g,f){var e=b[f].toString();if(e){return e}return g});return c}function updatecounter(a,b){if(b.title){a.find(".tile-stats h3").text(b.title.text);if(b.title.textStyle){a.find(".tile-stats h3").css(b.title.textStyle)}a.find(".tile-stats p").text(b.title.subtext);if(b.title.subtextStyle){a.find(".tile-stats p").css(b.title.subtextStyle)}}}function getDecimalSeparator(){var a=1.1;a=a.toLocaleString().substring(1,2);return a}function globalconnect(a){globalsocket=new SockJS(cp+"/subscribe");globalstompClient=Stomp.over(globalsocket);globalstompClient.debug=null;globalstompClient.connect(a,function(b){console.log("stomp connected");globalstompClient.subscribe("/user/"+uuid+"/info",function(e){var d=JSON.parse(e.body);switch(d.action){case"editdash":if(d.unloadRef!==globalstompClient.ws._transport.unloadRef){if(window.location.pathname===cp+"/dashboard/"+d.name){location.reload()}if(d.oldname){if(window.location.pathname===cp+"/dashboard/"+d.oldname){var c=encodeURI(cp+"/dashboard/"+d.name);window.location.href=c}else{location.reload()}}}break;case"deletedash":if(d.unloadRef!==globalstompClient.ws._transport.unloadRef){if(window.location.pathname===cp+"/dashboard/"+d.name){window.location=cp+"/dashboard/"}}break;default:break}});globalstompClient.subscribe("/all/info",function(c){})},function(b){console.log("Stomp:"+b);setTimeout(function(){globalconnect(a)},60000)})}function menuscroll(){var a=$(".left_col");a.eq(1).css("max-height",$(".sidebar-footer").offset().top);if($("body").hasClass("nav-sm")){$("#sidebar-menu").removeClass("y-overflow");if($("li").hasClass("active")){if($("li.active .nav.child_menu").length>0){$("li.active .nav.child_menu").css("max-height",$(window).scrollTop()+$(window).height()-$("li.active .nav.child_menu").offset().top);$("li.active .nav.child_menu").addClass("y-overflow")}}}else{$("#sidebar-menu").css("max-height",$(".sidebar-footer").offset().top-$("#sidebar-menu").offset().top);$("li.active .nav.child_menu").removeClass("y-overflow");$("li.active .nav.child_menu").css("max-height","");$("#sidebar-menu").addClass("y-overflow")}}function applyAlias(b,a){b=b.replace(new RegExp("\\{metric(.*?)\\}","g"),replacerM(a.metric));b=b.replace(new RegExp("\\{w+\\}","g"),replacer(a.tags));b=b.replace(new RegExp("\\{tag.(.*?)\\}","g"),replacer(a.tags));return b}function replacerM(a){return function(h,g){var e=g.split("|");if(typeof e[1]!=="undefined"){var d=new RegExp('r\\("(.*)","(.*)"\\)');if(d.test(e[1])){var c=e[1].match(d);var f=a;return f.replace(c[1],c[2])}var d=new RegExp('s\\("(.*)"\\)');if(d.test(e[1])){var c=e[1].match(d);var f=a;var b=f.indexOf(c[1]);if(b===-1){return f}return f.substr(0,b)}}return a}}function replacer(a){return function(h,g){var e=g.split("|");if(typeof a[e[0]]==="undefined"){return"tag."+e[0]}if(typeof e[1]!=="undefined"){var d=new RegExp('r\\("(.*)","(.*)"\\)');if(d.test(e[1])){var c=e[1].match(d);var f=a[e[0]];return f.replace(c[1],c[2])}var d=new RegExp('s\\("(.*)"\\)');if(d.test(e[1])){var c=e[1].match(d);var f=a[e[0]];var b=f.indexOf(c[1]);if(b===-1){return f}return f.substr(0,b)}}return a[e[0]]}}function compareStrings(d,c){d=d.toLowerCase();c=c.toLowerCase();return(d<c)?-1:(d>c)?1:0}function compareNameName(d,c){var h=d.name2;var f=c.name2;var g=d.name;var e=c.name;return((g<e))?-1:((g>e))?1:(((h<f))?-1:((h>f))?1:0)}function compareMetric(e,c,h){var i=e.info.name.toLowerCase();var f=c.info.name.toLowerCase();var g="NaN";var d="NaN";if(e.info.tags[h]){g=e.info.tags[h].value.toLowerCase()}if(c.info.tags[h]){d=c.info.tags[h].value.toLowerCase()}return((g<d))?-1:((g>d))?1:(((i<f))?-1:((i>f))?1:0)}function exportToCsv(b,g){var h=function(n){var m="";for(var l=0;l<n.length;l++){var k=n[l]===null?"":n[l].toString();if(n[l] instanceof Date){k=n[l].toLocaleString()}var i=k.replace(/"/g,'""');if(i.search(/("|,|\n)/g)>=0){i='"'+i+'"'}if(l>0){m+=","}m+=i}return m+"\n"};var f="";for(var d=0;d<g.length;d++){f+=h(g[d])}var a=new Blob([f],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob){navigator.msSaveBlob(a,b)}else{var e=document.createElement("a");if(e.download!==undefined){var c=URL.createObjectURL(a);e.setAttribute("href",c);e.setAttribute("download",b);e.style.visibility="hidden";document.body.appendChild(e);e.click();document.body.removeChild(e)}}}function exportTojson(c,a){var e=JSON.stringify(a);var b=new Blob([e],{type:"text/json;charset=utf-8;"});if(navigator.msSaveBlob){navigator.msSaveBlob(b,c)}else{var f=document.createElement("a");if(f.download!==undefined){var d=URL.createObjectURL(b);f.setAttribute("href",d);f.setAttribute("download",c);f.style.visibility="hidden";document.body.appendChild(f);f.click();document.body.removeChild(f)}}}function fullscreenrequest(b){if(!b){setCookie("fullscreen",true,{path:"/"});var a=$(".right_col").attr("style");setCookie("right_col_style",a,{path:"/"});$(".left_col,.nav_menu,#dash_main,.dash_action,.rawButton,.controls,.page-title").hide();$(".right_col,.widgetraw,.fulldash,.chartbkg,.editchartpanel").css("margin","0");$(".right_col,.widgetraw,.fulldash,.chartbkg,.editchartpanel").css("padding","0");$(".profile_right").css("width","100%");$RIGHT_COL.css("min-height",$(window).height())}else{setCookie("fullscreen",false,{path:"/"});$(".nav_menu,#dash_main,.dash_action,.rawButton,.controls,.page-title").show();$(".right_col").attr("style",getCookie("right_col_style"));$(".left_col,.profile_right,.widgetraw,.fulldash").removeAttr("style");$RIGHT_COL.css("min-height",$(window).height())}}function ModifierColor(d,g){var a=[];var h="1";var e=d.match(/^(#?([a-f\d]{3}|[a-f\d]{6})|rgb\((0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d),\s*(0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d),\s*(0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d)\)|rgba\((0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d),\s*(0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d),\s*(0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d),\s*(0?\.?\d+|1(\.0)?)\)|hsl\((0|360|35\d|3[0-4]\d|[12]\d\d|0?\d?\d),\s*(0|100|\d{1,\s*2})%,\s*(0|100|\d{1,\s*2})%\)|hsla\((0|360|35\d|3[0-4]\d|[12]\d\d|0?\d?\d),\s*(0|100|\d{1,\s*2})%,\s*(0|100|\d{1,\s*2})%,\s*(0?\.\d+|1(\.0)?)\))$/);if(typeof(e[2])!=="undefined"){var c=e[2];var b=c.length/3;for(var j=0;j<c.length;j=j+b){a.push(parseInt(c.substring(j,j+b),16))}}if(typeof(e[3])!=="undefined"){a=e.slice(3,6)}if(typeof(e[6])!=="undefined"){a=e.slice(6,9);h=e[9]}for(var f=0;f<a.length;f++){a[f]=Math.round(((((a[f]*360/255)+g)%360)*255)/360)}var k="rgba("+a[0]+","+a[1]+","+a[2]+","+h+")";return k}$(document).ready(function(){if(getCookie("small")=="true"){$("#sidebarMenu").hide();if($BODY.hasClass("nav-sm")){$("#sidebar, #content").addClass("active")}}if(!$(".profile_left-form").is(":visible")){$(".profile_right-table").css("width","100%")}$("body").on("click",".hidefilter",function(){$(".profile_left-form").show();$(".profile_right-table").removeAttr("style");if(typeof echartLine!=="undefined"){echartLine.resize()}});$("body").on("click","input",function(a){ga("send","event","input click",$(this).attr("name"))});$("body").on("click","a",function(a){ga("send","event","link click",$(this).attr("href"))});$("body").on("click","#allowedit",function(){var a=cp+"/switchallow";$.getJSON(a,null,function(b){location.reload()})});$("body").on("click","#FullScreen",function(){fullscreenrequest(getCookie("fullscreen")=="true")});$("body").on("click","#menu_toggle",function(){setCookie("small",getCookie("small")!="true",{path:"/"})});$("body").on("click",".nav.side-menu li",function(){menuscroll()})});$(window).on("load",function(){menuscroll()});$(window).resize(function(){menuscroll()});