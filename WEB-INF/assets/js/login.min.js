var xRows=40;var zRows=40;var cubeSize=600;var cubeGap=50;var cubeRow=cubeSize+cubeGap;var stageWidth=$(window).width();var stageHeight=$(window).height();var container=document.createElement("div");document.body.prepend(container);var camera=new THREE.PerspectiveCamera(55,stageWidth/stageHeight,1,20000);camera.position.y=5000;camera.lookAt(new THREE.Vector3(0,0,0));var scene=new THREE.Scene();scene.fog=new THREE.Fog(0,5000,10000);var pointLight=new THREE.PointLight(9097884);pointLight.intensity=2;pointLight.position.x=3000;pointLight.position.y=2500;pointLight.position.z=1000;scene.add(pointLight);group=new THREE.Object3D();scene.add(group);var cubes=[];var halfXRows=(cubeRow*-xRows/2);var halfZRows=(cubeRow*-zRows/2);var renderer=new THREE.WebGLRenderer();container.appendChild(renderer.domElement);var grid={x:0,z:0};var position={x:0,y:0,z:0};init();function init(){cubes=[];stageWidth=$(document).width();stageHeight=$(document).height();camera=new THREE.PerspectiveCamera(55,stageWidth/stageHeight,1,20000);renderer.setSize(stageWidth,stageHeight-7);for(var b=0;b<xRows;b++){cubes[b]=[];for(var h=0;h<zRows;h++){var f=100+Math.random()*700;f=10+(Math.sin(b/xRows*Math.PI)+Math.sin(h/zRows*Math.PI))*200+Math.random()*1000;var c=161240;var d=cubeSize;var g=new THREE.BoxGeometry(d,f,d);if(f>1320){c=16711680;d=cubeSize+100}var e=new THREE.MeshPhongMaterial({ambient:c,color:c,specular:c,shininess:10,shading:THREE.SmoothShading});var a=new THREE.Mesh(g,e);a.position.x=halfXRows+b*cubeRow;a.position.y=f/2;a.position.z=(cubeRow*-zRows/2)+h*cubeRow;a.height=f;group.add(a);cubes[b][h]=a}}}function checkRow(){var a=(position.x/cubeRow);var c=Math.floor(a/xRows);var e=(position.z/cubeRow);var h=Math.floor(e/zRows);for(var f=0;f<xRows;f++){for(var d=0;d<zRows;d++){var i,g=0;if(f>=a-c*xRows){i=xRows*(1-c)}else{i=xRows*(0-c)}if(d>=e-h*zRows){g=zRows*(1-h)}else{g=zRows*(0-h)}cubes[f][d].position.x=(f-i)*cubeRow-halfXRows;cubes[f][d].position.z=(d-g)*cubeRow-halfZRows;var b=(cubes[f][d].position.z+group.position.z)/1500;if(b<1){b=1}b=Math.pow(b,1.2);cubes[f][d].scale.y=b;cubes[f][d].position.y=(cubes[f][d].height*b)/2}}}var camPos=new THREE.Vector3(0,0,0);var mouse={x:0,y:0};var isRunning=true;function render(a){if(isRunning){requestAnimationFrame(render)}position.x+=(Math.sin(a*0.001))*3;position.z+=(Math.cos(a*0.0008)+5)*3;group.position.x=-position.x;group.position.z=-position.z;checkRow();camera.position.x=Math.sin(a*0.0003)*1000;camera.position.z=-4000;camera.position.y=(Math.cos(Math.sin(a*0.0009))+2)*2000;camera.lookAt(camPos);renderer.render(scene,camera)}render(0);window.addEventListener("mousedown",function(){isRunning=!isRunning;if(isRunning){render(0)}});$(document).ready(function(){$("body").on("focus","input",function(a){a.stopPropagation();a.preventDefault();isRunning=false})});window.addEventListener("mousemove",function(a){mouse=a});window.addEventListener("resize",function(a){init();render(0)});